{"version":3,"mappings":"uRAYIA,iBAAoEA,oBAAQA,iDAE5EA,oBAGEA,yCAASC,EAATC,OAASD,QAAO,KAMhBD,sBACAA,sBACFA,iCAJEA,qCAG+DA,oEAK7DA,oBAQEA,gBACFA,iEALEA,eACAA,kEAAoE,4BAHpEA,uBAMGA,oCAAiB,uDATxBA,SACEA,wBAUFA,6CAPKA,oGAUPA,qBAGEA,kDAASG,WAMVH,iCAJCA,iCAGAA,+DAvCOA,iBACTA,uBAEAA,0BAaAA,gBACEA,gCAYFA,QAEAA,0BAUFA,8BAzCmEA,iCAC3DA,iDAGHA,qDAYkBA,+CACWA,oCAe7BA,sDAYA,IAAMI,EAAY,MAAnB,QAUJC,YAAoBC,EAA8BC,EAAgCC,GAA9DC,qBAA8DA,kBATlFA,iBAA6B,KAC7BA,UAAgB,OAChBA,kBAAc,EACdA,iBAAa,EAELA,eAAY,IAAIC,IACxBD,gBAAa,EAIXA,KAAKE,YAAwE,IAA3DJ,EAAWK,cAAcC,UAAUC,QAAQ,YAG/DC,WACEN,KAAKD,WAAWQ,QAAQC,MAAKC,OAAUT,KAAKU,YAAYC,UAAWJ,IACjEP,KAAKO,QAAUA,EACf,MAAMK,EAmDZ,WAAkBC,EAAYC,GAC5B,OAAOD,EAAME,OAAO,CAACC,EAAQC,IAAUH,EAAGG,GAAQD,EAAS,EAAIA,EAAS,GApDlDE,CAAMlB,KAAKO,QAAUU,GAAwB,OAAfA,EAAKE,OAErDnB,KAAKoB,KACHR,EAAY,EAAKZ,KAAKE,WAAcU,EAAYZ,KAAKqB,WAAa,qBAAuB,iBAAoB,WAAc,SAIjIC,kBACOtB,KAAKE,aAIRqB,OAAcvB,KAAKD,WAAWyB,gBAAgBhB,QAAKiB,KAAYC,MAAQ1B,KAAK2B,MAAMC,QAAQpB,MAAKqB,OAAU7B,KAAK2B,SAC3GnB,QAAKC,KAAUT,KAAKU,YACpBC,UAAU,EAAEmB,EAAOH,MAElB,GADA3B,KAAK+B,YAAcD,EACL,OAAVA,GAAkBA,GAASH,EAAMK,OACnC,OAGF,MAAMC,EAAIN,EAAMO,UAAUJ,GAAO3B,cAC3BgC,EAAIF,EAAEG,aAENC,EAAQJ,EAAEK,wBACVC,EAAQJ,EAAEG,wBAIXE,EAFsBC,KAAOF,EAAME,KAAOJ,EAAMK,QAAUH,EAAMG,SAGnEP,EAAEQ,WAAaN,EAAMI,IAAMF,EAAME,IAAMN,EAAES,aAAe,KAMlEC,cACE7C,KAAKU,UAAUoC,KAAK,MAGtBC,OAAOC,GAAY,GACjBhD,KAAKiD,aAAejD,KAAKiD,YACrBD,GAAahD,KAAKiD,aACpBjD,KAAKkD,QAITA,QACElD,KAAKH,cAAcsD,4DAhEVxD,GAAYyD,6DAAZzD,EAAY0D,imCA5CZ9D,4BAAMA,6EA4CNI,GAAY,GC7CZ2D,EAAS,MAAhB,QAJN1D,cAKEI,4BAAoCL,gDADzB2D,4DAHF,CAAEC,KAAcC,SAGdF,GAAS","names":["i0","ctx_r5","oxw","ctx_r12","TocComponent","constructor","scrollService","elementRef","tocService","this","Subject","isEmbedded","nativeElement","className","indexOf","ngOnInit","tocList","pipe","takeUntil","onDestroy","subscribe","itemCount","array","fn","reduce","result","item","count","level","type","primaryMax","ngAfterViewInit","combineLatest","activeItemIndex","subscribeOn","asap","items","changes","startWith","index","activeIndex","length","e","toArray","p","offsetParent","eRect","getBoundingClientRect","pRect","isInViewport","top","bottom","scrollTop","clientHeight","ngOnDestroy","next","toggle","canScroll","isCollapsed","toTop","scrollToTop","t","selectors","TocModule","CommonModule","MatIconModule"],"sources":["./src/app/custom-elements/toc/toc.component.ts","./src/app/custom-elements/toc/toc.module.ts"],"sourcesContent":["import { AfterViewInit, Component, ElementRef, OnDestroy, OnInit, QueryList, ViewChildren } from '@angular/core';\r\nimport { asapScheduler as asap, combineLatest, Subject } from 'rxjs';\r\nimport { startWith, subscribeOn, takeUntil } from 'rxjs/operators';\r\n\r\nimport { ScrollService } from 'app/shared/scroll.service';\r\nimport { TocItem, TocService } from 'app/shared/toc.service';\r\n\r\ntype TocType = 'None' | 'Floating' | 'EmbeddedSimple' | 'EmbeddedExpandable';\r\n\r\n@Component({\r\n  selector: 'aio-toc',\r\n  template: `<div *ngIf=\"type !== 'None'\" class=\"toc-inner no-print\" [class.collapsed]=\"isCollapsed\">\r\n    <div *ngIf=\"type === 'EmbeddedSimple'\" class=\"toc-heading embedded\">Contents</div>\r\n\r\n    <button\r\n      *ngIf=\"type === 'EmbeddedExpandable'\"\r\n      type=\"button\"\r\n      (click)=\"toggle(false)\"\r\n      class=\"toc-heading embedded secondary\"\r\n      title=\"Expand/collapse contents\"\r\n      aria-label=\"Expand/collapse contents\"\r\n      [attr.aria-pressed]=\"!isCollapsed\"\r\n    >\r\n      Contents\r\n      <mat-icon class=\"rotating-icon\" svgIcon=\"keyboard_arrow_right\" [class.collapsed]=\"isCollapsed\"></mat-icon>\r\n    </button>\r\n\r\n    <ul class=\"toc-list\" [class.embedded]=\"type !== 'Floating'\">\r\n      <ng-container *ngFor=\"let toc of tocList; let i = index\">\r\n        <li\r\n          #tocItem\r\n          title=\"{{ toc.title }}\"\r\n          *ngIf=\"type === 'Floating' || toc.level !== 'h1'\"\r\n          class=\"{{ toc.level }}\"\r\n          [class.secondary]=\"type === 'EmbeddedExpandable' && i >= primaryMax\"\r\n          [class.active]=\"i === activeIndex\"\r\n        >\r\n          <a [href]=\"toc.href\" [innerHTML]=\"toc.content\"></a>\r\n        </li>\r\n      </ng-container>\r\n    </ul>\r\n\r\n    <button\r\n      *ngIf=\"type === 'EmbeddedExpandable'\"\r\n      type=\"button\"\r\n      (click)=\"toggle()\"\r\n      class=\"toc-more-items embedded material-icons\"\r\n      [class.collapsed]=\"isCollapsed\"\r\n      title=\"Expand/collapse contents\"\r\n      aria-label=\"Expand/collapse contents\"\r\n      [attr.aria-pressed]=\"!isCollapsed\"\r\n    ></button>\r\n  </div> `,\r\n  styles: [],\r\n})\r\nexport class TocComponent implements OnInit, AfterViewInit, OnDestroy {\r\n  activeIndex: number | null = null;\r\n  type: TocType = 'None';\r\n  isCollapsed = true;\r\n  isEmbedded = false;\r\n  @ViewChildren('tocItem') private items: QueryList<ElementRef>;\r\n  private onDestroy = new Subject();\r\n  primaryMax = 4;\r\n  tocList: TocItem[];\r\n\r\n  constructor(private scrollService: ScrollService, elementRef: ElementRef, private tocService: TocService) {\r\n    this.isEmbedded = elementRef.nativeElement.className.indexOf('embedded') !== -1;\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.tocService.tocList.pipe(takeUntil(this.onDestroy)).subscribe((tocList) => {\r\n      this.tocList = tocList;\r\n      const itemCount = count(this.tocList, (item) => item.level !== 'h1');\r\n\r\n      this.type =\r\n        itemCount > 0 ? (this.isEmbedded ? (itemCount > this.primaryMax ? 'EmbeddedExpandable' : 'EmbeddedSimple') : 'Floating') : 'None';\r\n    });\r\n  }\r\n\r\n  ngAfterViewInit() {\r\n    if (!this.isEmbedded) {\r\n      // We use the `asap` scheduler because updates to `activeItemIndex` are triggered by DOM changes,\r\n      // which, in turn, are caused by the rendering that happened due to a ChangeDetection.\r\n      // Without asap, we would be updating the model while still in a ChangeDetection handler, which is disallowed by Angular.\r\n      combineLatest(this.tocService.activeItemIndex.pipe(subscribeOn(asap)), this.items.changes.pipe(startWith(this.items)))\r\n        .pipe(takeUntil(this.onDestroy))\r\n        .subscribe(([index, items]) => {\r\n          this.activeIndex = index;\r\n          if (index === null || index >= items.length) {\r\n            return;\r\n          }\r\n\r\n          const e = items.toArray()[index].nativeElement;\r\n          const p = e.offsetParent;\r\n\r\n          const eRect = e.getBoundingClientRect();\r\n          const pRect = p.getBoundingClientRect();\r\n\r\n          const isInViewport = eRect.top >= pRect.top && eRect.bottom <= pRect.bottom;\r\n\r\n          if (!isInViewport) {\r\n            p.scrollTop += eRect.top - pRect.top - p.clientHeight / 2;\r\n          }\r\n        });\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.onDestroy.next(null);\r\n  }\r\n\r\n  toggle(canScroll = true) {\r\n    this.isCollapsed = !this.isCollapsed;\r\n    if (canScroll && this.isCollapsed) {\r\n      this.toTop();\r\n    }\r\n  }\r\n\r\n  toTop() {\r\n    this.scrollService.scrollToTop();\r\n  }\r\n}\r\n\r\nfunction count<T>(array: T[], fn: (item: T) => boolean) {\r\n  return array.reduce((result, item) => (fn(item) ? result + 1 : result), 0);\r\n}\r\n","import { NgModule, Type } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { MatIconModule } from '@angular/material/icon';\r\nimport { WithCustomElementComponent } from '../element-registry';\r\nimport { TocComponent } from './toc.component';\r\n\r\n@NgModule({\r\n  imports: [ CommonModule, MatIconModule ],\r\n  declarations: [ TocComponent ]\r\n})\r\nexport class TocModule implements WithCustomElementComponent {\r\n  customElementComponent: Type<any> = TocComponent;\r\n}\r\n"],"sourceRoot":"webpack:///","file":"786.fbce69200d4141c9.js"}