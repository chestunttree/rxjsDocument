{"version":3,"mappings":"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","names":["ApiService","constructor","http","logger","this","DOC_CONTENT_URL_PREFIX","Subject","ReplaySubject","sectionsSubject","pipe","takeUntil","onDestroy","sections","firstTime","fetchSections","_sections","subscribe","log","tap","forEach","section","deprecated","items","every","item","stability","ngOnDestroy","next","src","url","apiBase","apiListJsonDefault","get","err","error","t","factory","i0","ApiListComponent","apiService","locationService","SearchCriteria","value","title","ngOnInit","filteredSections","combineLatest","criteriaSubject","map","results","criteria","Object","filterSection","initializeSearchCriteria","setQuery","query","setSearchCriteria","toLowerCase","trim","setStatus","status","toggleStatusMenu","setType","type","toggleTypeMenu","showStatusMenu","showTypeMenu","filter","docType","matchesType","securityRisk","matchesStatus","name","indexOf","matchesQuery","length","search","q","queryEl","nativeElement","statuses","find","x","types","searchCriteria","setLocationSearch","setSearch","undefined","assign","selectors","ctx","ApiListModule","imports","CommonModule","SharedModule","HttpClientModule"],"sources":["./src/app/custom-elements/api/api.service.ts","./src/app/custom-elements/api/api-list.component.ts","./src/app/custom-elements/api/api-list.module.ts"],"sourcesContent":["import { Injectable, OnDestroy } from '@angular/core';\r\nimport { HttpClient, HttpErrorResponse } from '@angular/common/http';\r\n\r\nimport { ReplaySubject, Subject } from 'rxjs';\r\nimport { takeUntil, tap } from 'rxjs/operators';\r\n\r\nimport { Logger } from 'app/shared/logger.service';\r\nimport { DOC_CONTENT_URL_PREFIX } from 'app/documents/document.service';\r\n\r\nexport interface ApiItem {\r\n  name: string;\r\n  title: string;\r\n  path: string;\r\n  docType: string;\r\n  stability: string;\r\n  securityRisk: boolean;\r\n}\r\n\r\nexport interface ApiSection {\r\n  path: string;\r\n  name: string;\r\n  title: string;\r\n  deprecated: boolean;\r\n  items: ApiItem[]|null;\r\n}\r\n\r\n@Injectable()\r\nexport class ApiService implements OnDestroy {\r\n\r\n  private apiBase = DOC_CONTENT_URL_PREFIX + 'api/';\r\n  private apiListJsonDefault = 'api-list.json';\r\n  private firstTime = true;\r\n  private onDestroy = new Subject();\r\n  private sectionsSubject = new ReplaySubject<ApiSection[]>(1);\r\n  private _sections = this.sectionsSubject.pipe(takeUntil(this.onDestroy));\r\n\r\n  /**\r\n   * Return a cached observable of API sections from a JSON file.\r\n   * API sections is an array of Angular top modules and metadata about their API documents (items).\r\n   */\r\n  get sections() {\r\n\r\n    if (this.firstTime) {\r\n      this.firstTime = false;\r\n      this.fetchSections(); // TODO: get URL for fetchSections by configuration?\r\n\r\n      // makes sectionsSubject hot; subscribe ensures stays alive (always refCount > 0);\r\n      this._sections.subscribe(() => this.logger.log('ApiService got API sections') );\r\n    }\r\n\r\n    return this._sections.pipe(tap(sections => {\r\n      sections.forEach(section => {\r\n        section.deprecated = !!section.items &&\r\n            section.items.every(item => item.stability === 'deprecated');\r\n      });\r\n    }));\r\n  }\r\n\r\n  constructor(private http: HttpClient, private logger: Logger) { }\r\n\r\n  ngOnDestroy() {\r\n    this.onDestroy.next(null);\r\n  }\r\n\r\n /**\r\n  * Fetch API sections from a JSON file.\r\n  * API sections is an array of Angular top modules and metadata about their API documents (items).\r\n  * Updates `sections` observable\r\n  *\r\n  * @param src Name of the api list JSON file\r\n  */\r\n  fetchSections(src?: string) {\r\n    // TODO: get URL by configuration?\r\n    const url = this.apiBase + (src || this.apiListJsonDefault);\r\n    this.http.get<ApiSection[]>(url)\r\n      .pipe(\r\n        takeUntil(this.onDestroy),\r\n        tap(() => this.logger.log(`Got API sections from ${url}`)),\r\n      )\r\n      .subscribe(\r\n        sections => this.sectionsSubject.next(sections),\r\n        (err: HttpErrorResponse) => {\r\n          // TODO: handle error\r\n          this.logger.error(err);\r\n          throw err; // rethrow for now.\r\n        }\r\n      );\r\n  }\r\n}\r\n","/*\r\n * API List & Filter Component\r\n *\r\n * A page that displays a formatted list of the public Angular API entities.\r\n * Clicking on a list item triggers navigation to the corresponding API entity document.\r\n * Can add/remove API entity links based on filter settings.\r\n */\r\n\r\nimport { Component, ElementRef, OnInit, ViewChild } from '@angular/core';\r\n\r\nimport { combineLatest, Observable, ReplaySubject } from 'rxjs';\r\n\r\nimport { LocationService } from 'app/shared/location.service';\r\nimport { ApiSection, ApiService } from './api.service';\r\n\r\nimport { Option } from 'app/shared/select/select.component';\r\nimport { map } from 'rxjs/operators';\r\n\r\nclass SearchCriteria {\r\n  query? = '';\r\n  status? = 'all';\r\n  type? = 'all';\r\n}\r\n\r\n@Component({\r\n  selector: 'aio-api-list',\r\n  template: `<div class=\"l-flex-wrap api-filter\">\r\n      <aio-select (change)=\"setType($event.option)\" [options]=\"types\" [selected]=\"type\" [showSymbol]=\"true\" label=\"Type:\"> </aio-select>\r\n\r\n      <div class=\"form-search\">\r\n        <input #filter placeholder=\"Filter\" aria-label=\"Filter\" (input)=\"setQuery(filter.value)\" />\r\n        <i class=\"material-icons\">search</i>\r\n      </div>\r\n    </div>\r\n\r\n    <article class=\"api-list-container l-content-small docs-content\">\r\n      <div *ngFor=\"let section of filteredSections | async\">\r\n        <h2 [id]=\"section.title\" *ngIf=\"section.items\">{{ section.title }}</h2>\r\n        <ul class=\"api-list\" *ngIf=\"section.items?.length\">\r\n          <ng-container *ngFor=\"let item of section.items\">\r\n            <li class=\"api-item\">\r\n              <a [href]=\"item.path\">\r\n                <span class=\"symbol {{ item.docType }}\"></span>\r\n                <span class=\"stability {{ item.stability }}\"\r\n                  >{{ item.title }} {{ !item.stability || item.stability === 'stable' ? '' : '(' + item.stability + ')' }}</span\r\n                >\r\n              </a>\r\n            </li>\r\n          </ng-container>\r\n        </ul>\r\n      </div>\r\n    </article> `,\r\n})\r\nexport class ApiListComponent implements OnInit {\r\n  filteredSections: Observable<ApiSection[]>;\r\n\r\n  showStatusMenu = false;\r\n  showTypeMenu = false;\r\n\r\n  private criteriaSubject = new ReplaySubject<SearchCriteria>(1);\r\n  private searchCriteria = new SearchCriteria();\r\n\r\n  status: Option;\r\n  type: Option;\r\n\r\n  // API types\r\n  types: Option[] = [\r\n    { value: 'all', title: 'All' },\r\n    { value: 'class', title: 'Class' },\r\n    { value: 'const', title: 'Const' },\r\n    { value: 'enum', title: 'Enum' },\r\n    { value: 'function', title: 'Function' },\r\n    { value: 'interface', title: 'Interface' },\r\n    { value: 'type-alias', title: 'Type alias' },\r\n  ];\r\n\r\n  statuses: Option[] = [\r\n    { value: 'all', title: 'All' },\r\n    { value: 'deprecated', title: 'Deprecated' },\r\n    { value: 'security-risk', title: 'Security Risk' },\r\n  ];\r\n\r\n  @ViewChild('filter', { static: true }) queryEl: ElementRef;\r\n\r\n  constructor(private apiService: ApiService, private locationService: LocationService) {}\r\n\r\n  ngOnInit() {\r\n    this.filteredSections = combineLatest(this.apiService.sections, this.criteriaSubject).pipe(\r\n      map((results) => ({ sections: results[0], criteria: results[1] })),\r\n      map((results) => results.sections.map((section) => ({ ...section, items: this.filterSection(section, results.criteria) })))\r\n    );\r\n\r\n    this.initializeSearchCriteria();\r\n  }\r\n\r\n  // TODO: may need to debounce as the original did\r\n  // although there shouldn't be any perf consequences if we don't\r\n  setQuery(query: string) {\r\n    this.setSearchCriteria({ query: (query || '').toLowerCase().trim() });\r\n  }\r\n\r\n  setStatus(status: Option) {\r\n    this.toggleStatusMenu();\r\n    this.status = status;\r\n    this.setSearchCriteria({ status: status.value });\r\n  }\r\n\r\n  setType(type: Option) {\r\n    this.toggleTypeMenu();\r\n    this.type = type;\r\n    this.setSearchCriteria({ type: type.value });\r\n  }\r\n\r\n  toggleStatusMenu() {\r\n    this.showStatusMenu = !this.showStatusMenu;\r\n  }\r\n\r\n  toggleTypeMenu() {\r\n    this.showTypeMenu = !this.showTypeMenu;\r\n  }\r\n\r\n  //////// Private //////////\r\n\r\n  private filterSection(section: ApiSection, { query, status, type }: SearchCriteria) {\r\n    const items = section.items!.filter((item) => {\r\n      return matchesType() && matchesStatus() && matchesQuery();\r\n\r\n      function matchesQuery() {\r\n        return !query || section.name.indexOf(query) !== -1 || item.name.indexOf(query) !== -1;\r\n      }\r\n\r\n      function matchesStatus() {\r\n        return status === 'all' || status === item.stability || (status === 'security-risk' && item.securityRisk);\r\n      }\r\n\r\n      function matchesType() {\r\n        return type === 'all' || type === item.docType;\r\n      }\r\n    });\r\n\r\n    // If there are no items we still return an empty array if the section name matches and the type is 'package'\r\n    return items.length ? items : type === 'package' && (!query || section.name.indexOf(query) !== -1) ? [] : null;\r\n  }\r\n\r\n  // Get initial search criteria from URL search params\r\n  private initializeSearchCriteria() {\r\n    const { query, status, type } = this.locationService.search();\r\n\r\n    const q = (query || '').toLowerCase();\r\n    // Hack: can't bind to query because input cursor always forced to end-of-line.\r\n    this.queryEl.nativeElement.value = q;\r\n\r\n    this.status = this.statuses.find((x) => x.value === status) || this.statuses[0];\r\n    this.type = this.types.find((x) => x.value === type) || this.types[0];\r\n\r\n    this.searchCriteria = {\r\n      query: q,\r\n      status: this.status.value,\r\n      type: this.type.value,\r\n    };\r\n\r\n    this.criteriaSubject.next(this.searchCriteria);\r\n  }\r\n\r\n  private setLocationSearch() {\r\n    const { query, status, type } = this.searchCriteria;\r\n    const params = {\r\n      query: query ? query : undefined,\r\n      status: status !== 'all' ? status : undefined,\r\n      type: type !== 'all' ? type : undefined,\r\n    };\r\n\r\n    this.locationService.setSearch('API Search', params);\r\n  }\r\n\r\n  private setSearchCriteria(criteria: SearchCriteria) {\r\n    this.criteriaSubject.next(Object.assign(this.searchCriteria, criteria));\r\n    this.setLocationSearch();\r\n  }\r\n}\r\n","import { NgModule, Type } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { SharedModule } from '../../shared/shared.module';\r\nimport { ApiListComponent } from './api-list.component';\r\nimport { ApiService } from './api.service';\r\nimport { WithCustomElementComponent } from '../element-registry';\r\n\r\n@NgModule({\r\n  imports: [ CommonModule, SharedModule, HttpClientModule ],\r\n  declarations: [ ApiListComponent ],\r\n  providers: [ ApiService ]\r\n})\r\nexport class ApiListModule implements WithCustomElementComponent {\r\n  customElementComponent: Type<any> = ApiListComponent;\r\n}\r\n"],"sourceRoot":"webpack:///","file":"858.aa1fd87fe5834720.js"}